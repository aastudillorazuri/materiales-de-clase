Las referencias de celdas se refieren a cuando realizamos cálculos en Excel. A cada celda que llamamos dentro de un cálculo, estamos haciendo que sea una referencia. De tal modo, que si en la celda B3 de una hoja de cálculo tenemos la fórmula: B3= A1 * C2, en dicha fórmula estamos haciendo dos referencias, una a la celda A1 y otra a la celda C2.

La referencia es la manera en la que se comportan las celdas cuando copiamos un cálculo.

Lo más habitual que solemos hacer al escribir un cálculo en una celda de una columna es, después de haberlo puesto, copiarlo al resto de celdas de la columna. De tal manera, que para que se copie bien dicho cálculo en todas las celdas, debemos definir bien la referencia a cada celda.

Los dos tipos de referencia más frecuentes que tenemos en Excel son la referencia relativa y la referencia absoluta, que son las dos que vamos a pasar a explicar.

* Referencia relativa

La referencia que por defecto hace Excel a cualquier celda que seleccionemos dentro de la hoja de cálculo en una fórmula, es relativa. Esto se sabe porque al seleccionar cualquier celda a la hora de escribir la fórmula, sobre ella no vemos escrito el símbolo del dólar ($).

En caso de ver sobre una celda seleccionada dicho símbolo de $, la referencia no sería relativa.

En el fichero 11_referencias_relativas_a, tenemos un rango de diferentes productos que compramos, con el precio de compra y el precio al que lo vendemos. Queremos calcular, inicialmente, el margen de beneficio que obtenemos por la venta de cada producto, es decir, que la operación que haremos de cada producto será: PRECIO VENTA – PRECIO COMPRA.

Por tanto, nos posicionamos en la celda D2 y escribimos la siguiente fórmula: =C2-B2.

Tanto la celda C2, como la celda B2 tienen una referencia relativa. En este caso, tenemos que saber cómo se van a comportar ambas celdas cuando vayamos a copiar la fórmula.

Las celdas que tienen referencia relativa, al copiar una fórmula o cálculo, se van a desplazar o mover tantas columnas y tantas filas como nos desplacemos nosotros desde la celda que copiamos (la que tiene la fórmula) hasta la celda en la que peguemos dicha fórmula.

Es decir, la referencia relativa la utilizamos en los casos donde llamamos a datos que vayan cambiando de celda, como es el ejemplo que estamos planteando:

- El PRECIO VENTA de cada producto va cambiando para cada uno de ellos, es decir, el PRODUCTO A tiene un precio de venta, el PRODUCTO B otro precio de venta, y así sucesivamente para cada producto. Por tanto, la referencia que tenemos que hacer a C2 (la celda que representa el PRECIO VENTA) es relativa, para que cuando copiemos la fórmula al resto de productos, vaya cambiando y seleccionando el precio venta del producto correspondiente.

- El PRECIO COMPRA, al igual que el PRECIO VENTA, es diferente para cada producto, de tal manera que, como vamos a querer copiar la fórmula para el resto de los productos, tendremos que dejar a la celda B2 también una referencia relativa.

Por tanto, dejamos tanto C2 como B2 con dicha referencia relativa y pulsamos la tecla INTRO o ENTER para validar la fórmula y que Excel nos muestre el resultado.

Al tener bien ajustada ya la referencia de ambas celdas en la fórmula escrita, podemos copiarla al resto de celdas de la columna para calcular automáticamente el margen de beneficio del resto de los productos.

Para copiar la fórmula podemos utilizar los comandos de copiar y pegar, o bien utilizar el selector de autorrelleno de la celda activa, que es el punto situado en la esquina inferior derecha de la celda activa.

Posicionando el ratón en dicho selector, hacemos dos clics rápidos al botón izquierdo del ratón y la fórmula se copia hasta el último producto. También, podemos colocarnos en dicho selector de autorrelleno y arrastrar con el botón izquierdo del ratón hasta llegar al margen de beneficio del último producto que vayamos a copiar.

* Referencia absoluta

La referencia absoluta consiste en blindar o bloquear una celda para que cuando vayamos a copiar la fórmula, dichas celdas que tienen referencia absoluta nunca cambien, es decir, permanezcan constantes.

Se aplica en las fórmulas o cálculos a celdas que nunca cambian para ninguno de los datos.

Para blindar una celda o hacer referencia absoluta, tenemos que bloquear su columna y bloquear la fila de la propia celda. Para ello, ponemos el símbolo del $ delante de la letra de la columna, y también ponemos el símbolo del $ delante del número de la fila. Es decir, que si queremos dejar blindada la celda B1 tendrá que quedar escrita como: $B$1.

Un método abreviado para blindar o hacer referencia absoluta a una celda, sería teniendo el cursor pegado en la fórmula a la dirección de la celda que queremos blindar, pulsamos en el teclado la tecla de función F4 (en caso de tener portátil, puede que al pulsar la tecla F4 no se ponga el símbolo del $ en la celda, en ese caso tendremos que localizar la tecla FN y con ella pulsada apretamos la tecla F4).

Abrimos el fichero 11_referencia_absoluta_a que nos muestra una hoja en la que tenemos una lista de 5 vendedores, con el importe vendido por cada uno de ellos.

En las filas de la 1 a la 3, tenemos una tabla que nos indica lo siguiente:

- Todos los vendedores tienen una comisión del 2 % sobre el importe vendido
- A todos se les retiene un 8 % sobre su sueldo bruto
- Todos tienen un mismo salario base de 1.250 €.

Lo primero que vamos a hacer será calcular la columna IMPORTE COMISION, que sería el IMPORTE VENDIDO * COMISION.

De tal forma que nos colocamos en C6 para calcular el importe comisión del primer vendedor y ponemos la fórmula: =B6*B1.

Vemos como, de momento, tanto la cela B6 como la celda B1, las estamos haciendo referencia relativa, pero si analizamos ambos valores debemos tener en cuenta lo siguiente:

- El IMPORTE VENDIDO (B6) va cambiando para cada vendedor, es decir, que cada vendedor tiene un importe vendido diferente, por tanto, es correcto dejar a B6 referencia relativa
- La COMISION (B1) vemos que es la misma para todos los vendedores, es decir, nunca cambia, por ello en este caso a B1 no le podemos hacer referencia relativa, ya que en ese caso estaríamos indicando que cada vendedor tendría una comisión diferente, es decir, para el primer vendedor cogería la comisión de B1, pero para el segundo de B2, para el tercero de B3 y así sucesivamente, y esto no sería correcto. Por lo tanto, al ser la comisión un valor constante, que es la misma para todos los vendedores, tendremos que marcarla una referencia absoluta, es decir, ponerla como $B$1. Para ello, dentro de la fórmula, colocamos el cursor pegado a la dirección de la celda B1 y pulsamos la tecla de función F4 (como hemos indicado anteriormente) para que se marque la referencia absoluta y la fórmula quede como: =B6*$B$1

Una vez que hemos ajustado ambas referencias, pulsamos ENTER y podemos copiar la fórmula al resto de los vendedores.

* Calcular columnas en una tabla

Los cálculos explicados en el punto anterior, los hemos realizado sobre un rango y en ellos se ha hecho referencia a cada celda que formaba parte del cálculo a través de su dirección.

Sin embargo, cuando lo hacemos dentro de una tabla, la sintaxis cambia, de tal manera que, como a continuación vamos a ver, no se va a reflejar la dirección de la celda dentro del cálculo.

Vamos a calcular los datos de una nueva columna a continuación de la última en el fichero 11_bd_cursos_a, y la vamos a nombrar GASTO en la columna P.

Lo que vamos a calcular es el gasto de cada curso, que sería el gasto en profesor: campo IMPORTE PROFESOR + el gasto en COMERCIAL: campo IMPORTE COMERCIAL. Para ello, nos posicionamos en la celda debajo del título GASTO y procedemos a escribir la fórmula. Al hacerlo, la sintaxis que quedará escrita es la que a continuación se muestra: =[@[IMPORTE PROFESOR]]+[@[IMPORTE COMERCIAL]].

En caso de haber estado dentro de un rango, la expresión de la fórmula hubiera sido: G2+K2.

Pero en las tablas, al clicar la celda que llamamos en el cálculo, en este caso la celda que tiene el IMPORTE PROFESOR que está en la celda G2, Excel muestra: [@[IMPORTE PROFESOR]].

La @ quiere decir FILA ACTUAL, es decir, nos indica que estamos cogiendo un dato de la tabla que está situado en la misma fila en la que estamos calculando, en concreto de la columna IMPORTE PROFESOR, ya que es el nombre de la columna que ha quedado escrito en la fórmula.
De manera similar, ocurre con el campo [@[IMPORTE COMERCIAL]], donde Excel nos indica que estamos seleccionando un dato que está en la misma fila que estamos calculando y que pertenece a la columna IMPORTE COMERCIAL.

Una vez completada la fórmula, al pulsar la tecla ENTER y mostrar el resultado, dicha fórmula se copia de manera automática para toda la columna de la tabla. Es otra diferencia notable sobre los cálculos en un rango, los cuales, terminado de escribir el cálculo, tenemos que copiar nosotros para el resto de la columna, tal y como hicimos en el punto anterior.

No obstante, podemos escribir manualmente el cálculo usando las direcciones de las celdas dentro de la tabla. Para ello, tendríamos que teclear nosotros la dirección de la celda. Es decir, funcionaría igualmente el cálculo si hubiéramos escrito la fórmula: =G2+K2. Pulsando la tecla ENTER, mostraría el resultado y también se copiaría para el resto de la columna de la tabla.