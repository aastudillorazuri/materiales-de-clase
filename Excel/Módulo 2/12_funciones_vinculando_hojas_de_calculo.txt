Los cálculos que hemos realizado hasta ahora han sido usando datos que están en la misma hoja sobre la que estamos escribiendo el cálculo.

No obstante, podemos realizar cálculos desde una hoja llamando a datos que se encuentran en una hoja diferente. Esta acción de calcular sobre datos situados en otras hojas, se llama vincular hojas de cálculo.

Sobre los datos del fichero 12_bd_cursos_rango_a, vamos a explicar cómo vincular hojas de cálculo sobre rangos de celdas. Dicho fichero, tiene las mismas columnas y filas que el fichero 01_bd_cursos (sin las columnas calculadas en el punto anterior) que hemos estado utilizando en explicaciones anteriores, pero teniendo los datos como un rango.

Insertamos una hoja con el nombre CALCULOS y en ella es donde vamos a realizar los cálculos sobre los datos que tenemos en la hoja CURSOS.

* Función SUMA

Mediante la función SUMA, podemos sumar todas las celdas que seleccionemos desde un rango hasta un máximo de 256 rango.

Vamos a sumar en la celda B1 de la hoja cálculos, el gasto total, que serían los datos de la columna IMPORTE PROFESOR y de la columna IMPORTE COMERCIAL de la hoja CURSOS.

En la celda A1 ponemos el título de lo que vamos a calcular, por ejemplo: TOTAL GASTO. A continuación, nos colocamos en B1 y comenzamos con el cálculo poniendo el signo = y el nombre de la función SUMA. A medida que estamos escribiendo el nombre de la función, Excel nos muestra una lista de funciones que comienzan con el nombre que estamos escribiendo.

En el momento que la tengamos localizada en pantalla, haciendo un clic sobre ella quedará seleccionada y nos muestra una etiqueta con la definición de la función.

Para que Excel escriba el nombre de la función por nosotros, haremos 2 clics rápidos con el ratón sobre el nombre. De esta forma, Excel completa el nombre de la función y abre el paréntesis.

Ten en cuenta...
Siempre, en cualquier función que utilicemos, al finalizar el nombre de esta debemos tener abierto el paréntesis, ya que, dentro de dicho paréntesis, tenemos que dar los argumentos a la función, es decir, en este caso, le tenemos que indicar dentro de dicho paréntesis los rangos de celdas que vamos a sumar.

Una vez abierto el paréntesis, la función ofrece por debajo del nombre una etiqueta de ayuda de esta, donde nos muestra los argumentos que tenemos que dar a la función para que esta nos dé el resultado.

En este caso, vemos que el primer argumento lo llama: número 1, será el primer rango de celdas que vamos a sumar. Una vez dado el primer argumento, pondremos el signo de punto y coma, tal y como muestra la etiqueta de ayuda, para separarlo del siguiente argumento que llama número 2.

En esta función vemos que la etiqueta de ayuda termina en puntos suspensivos. Esto quiere decir, que admite un máximo de 256 argumentos, todas las funciones que terminan así admiten ese número máximo de argumentos. Siempre separando uno de otro por punto y coma.

Una vez que hayamos escrito el último argumento tendremos que cerrar el paréntesis abierto. Por lo tanto, en este ejemplo, una vez abierto el paréntesis de la función SUMA, como los datos que vamos a sumar los tenemos en la hoja CURSOS, con el ratón pulsamos sobre el nombre de la solapa CURSOS (aquí estamos generando el vínculo con la hoja CURSOS, si miramos la barra de fórmulas dicho vínculo se muestra con el nombre de la hoja incluyendo al final el signo de exclamación: CURSOS!)

1. Seleccionamos el primer rango que vamos a sumar que serían los datos de la columna IMPORTE PROFESOR.
2. Para separar este rango del siguiente que vamos a sumar, pondremos el signo de punto y coma desde el teclado.
3. Seleccionamos los datos de la columna IMPORTE COMERCIAL.
4. Como este es el último rango que vamos a sumar, una vez seleccionado le damos a la tecla de cerrar paréntesis para que el paréntesis abierto quede cerrado.

El paréntesis siempre se cierra desde la hoja en la que hemos seleccionado el último argumento, en este caso, desde la hoja CURSOS.

Pulsamos la tecla ENTER y vemos como Excel nos lleva a la hoja CALCULOS y nos muestra el resultado. La fórmula escrita debe de quedar como sigue:

=SUMA(CURSOS!G2:G363;CURSOS!K2:K363)

Si vemos la fórmula en la barra de fórmulas, nos indica que estamos tomando datos de la hoja CURSOS y después de la exclamación, nos muestra el rango de dicha hoja que hemos tomado. En este caso en el primer rango los datos de la columna G y en el segundo los datos de la columna K. El resultado será: 131.949,65.

* Función CONTAR

La función CONTAR, cuenta el número de celdas desde un rango a un máximo de 256 que tienen dato numérico. Es decir, no cuenta ni celdas con texto ni celdas que estén vacías.

Su sintaxis es similar a la de la función SUMA, sólo que en vez de sumar lo que hace es un conteo de celdas con dato numérico.

* Función CONTARA

La función CONTARA, cuenta el número de celdas desde un rango hasta un máximo de 256 rangos, que no están vacías, es decir, cuenta tanto celdas con dato numérico, como celdas con dato texto.

La sintaxis también es similar a la de las funciones SUMA y CONTAR. Entre la función CONTAR y la función CONTARA, la más habitual de utilizar es la función CONTARA.

* Función CONTAR.SI

La función CONTAR.SI cuenta el número de celdas de un rango que cumplen con una determinada condición que nosotros establezcamos.

La sintaxis de dicha función es diferente a las de las anteriores, ya que, en este caso, esta función sólo admite dos argumentos que son:

- Rango: Es el rango o la columna donde vamos a ir a contar.
- Criterio: Es la condición que han de cumplir las celdas del rango o columna que hemos seleccionado en el argumento anterior.

Si escribimos el argumento mediante el teclado, debemos introducirlo entre comillas. En caso de seleccionar el criterio desde una celda, no tienen que escribirse comillas.

En el criterio podemos usar los comparadores:

Signo	Significado
>	Mayor
>=	Mayor o igual
<	Menor
<=	Menor o igual
<>	Distinto

El comparador siempre va escrito dentro de las comillas del criterio.

* Vincular sobre una tabla

Para vincular los datos a una tabla, no será necesario realizar los cambios de hoja para seleccionar los rangos o las columnas.

Vamos a insertar una hoja que nombraremos CALCULOS TABLA.

1. En primer lugar, vamos a realizar la operación con la función SUMA, para sumar los datos de las columnas IMPORTE PROFESOR e IMPORTE COMERCIAL que están en la tabla de la hoja CURSOS, la cual tenemos nombrada como T_CURSOS.

Para ello, ponemos el título en la celda A1 de la hoja cálculos: TOTAL GASTO y en la celda B1 vamos a realizar la suma de esas dos columnas de la tabla.

2. Empezamos introduciendo el nombre de la función: =SUMA(

Ahora bien, en este caso, las columnas que queremos sumar se encuentran en la tabla T_CURSOS, por lo que, primero, vamos a introducir el nombre de la tabla y a continuación abrimos corchetes en el teclado: T_CURSOS[

Excel nos muestra una lista desplegable con los nombres de todas las columnas que tiene la tabla.

3. Seguidamente, lo que tendremos que hacer es colocarnos sobre el nombre de la columna que vamos a sumar primero: IMPORTE PROFESOR y pulsamos dos clics rápidos sobre él, de esta forma Excel nos escribe el nombre. Seguido del nombre de la columna cerramos corchetes. Los nombres de las columnas de las tablas SIEMPRE tenemos que ponerlos entre corchetes.

4. Antes de seleccionar la siguiente columna en el segundo argumento, como siempre, ponemos el signo de punto y coma para, después, seleccionar la segunda columna de la misma forma que la anterior, es decir, ponemos primero el nombre de la tabla en la que se encuentra la columna: T_CURSOS, abrimos corchete y seleccionamos la columna IMPORTE COMERCIAL. Cerramos corchetes y el paréntesis de la función, ya que no vamos a sumar más columnas y nos muestra el resultado.

La función quedará de la siguiente forma:

=SUMA(T_CURSOS[IMPORTE PROFESOR];T_CURSOS[IMPORTE COMERCIAL])

Por tanto, cuando los cálculos los realizamos vinculando a una tabla, vemos que no es necesario realizar los cambios de hojas.

Ten en cuenta...
Siempre que, en algún argumento de una función, tengamos que seleccionar una columna de la tabla, procedemos de la manera indicada.

No obstante, podríamos también realizar los cambios de hojas, al igual que en los rangos, y seleccionar las columnas, pero quedará escrito el cálculo igualmente, con la sintaxis vista ahora de la tabla.

Con todas las funciones explicadas hasta ahora se procede de la misma forma al seleccionar columnas de una tabla.